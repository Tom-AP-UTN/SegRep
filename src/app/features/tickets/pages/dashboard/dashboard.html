@if (!ticket) {
  <p class="text-gray-600 text-center mt-10">No hay tickets aún.</p>
} @else {

<div class="grid grid-cols-3 gap-6 p-6">

  <!-- COLUMNA GRANDE (2/3) → Update + Detalle -->
  <div class="col-span-2 bg-white p-6 rounded shadow">

    <h2 class="text-xl font-bold mb-4">Último Ticket</h2>

    <!-- Título -->
    <p class="text-lg font-semibold mb-2">
      {{ ticket.titulo }}
    </p>

    @if (rol === 'tecnico' && ticket) {
  <div class="flex gap-3 mb-4">

    <button
      class="px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700"
      [routerLink]="['/app/tickets', ticket.id, 'new-update']"
    >
      + Nuevo Update
    </button>

    <button
      class="px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700"
      [routerLink]="['/app/tickets', ticket.id]"
    >
      Ver Ticket
    </button>

  </div>
}


    <!-- Descripción -->
    <p class="text-gray-700 mb-4">
      {{ ticket.descripcion }}
    </p>

    <!-- Tipo de máquina -->
    <p class="text-sm text-gray-500 mb-2">
      Máquina: {{ ticket.tipoMaquina }}
    </p>

    <!-- Estado -->
    <p class="text-sm mb-4">
      Estado:
      <span class="font-semibold">{{ ticket.estado }}</span>
    </p>

    <!-- Fecha -->
    <p class="text-sm text-gray-500 mb-4">
      Creado: {{ ticket.fechaCreacion | date:'short' }}
    </p>

    <!-- Update -->
    @if (update) {
      <div class="mt-6 p-4 border rounded bg-gray-50">
        <p class="font-semibold mb-2">Último update</p>
        <p>{{ update.detalleUpdate }}</p>

        @if (update.nuevoEstado) {
          <p class="mt-2 text-sm">
            Nuevo estado: <strong>{{ update.nuevoEstado }}</strong>
          </p>
        }

        <p class="text-xs text-gray-500 mt-1">
          {{ update.fechaUpdate }}
        </p>
      </div>
    }

  </div>

  <!-- COLUMNA CHICA (1/3) → Info del otro usuario -->
  <div class="col-span-1 bg-white p-6 rounded shadow">

    <h3 class="text-lg font-bold mb-4">
      @if (rol === 'tecnico') {
        Cliente
      } @else {
        Técnico
      }
    </h3>

    @if (!otroUsuario) {
      <p class="text-gray-500">Cargando...</p>
    } @else {

      <p class="font-semibold mb-2">
        {{ otroUsuario.nombre }} {{ otroUsuario.apellido }}
      </p>

      <p class="text-gray-700 mb-2">
        Email: {{ otroUsuario.email }}
      </p>

      <p class="text-gray-700 mb-2">
        Celular: {{ otroUsuario.celular }}
      </p>

      @if (rol === 'tecnico') {
        <!-- datos del cliente -->
        <p class="text-gray-700">Dirección: {{ otroUsuario.direccion }}</p>
      }

    @if (rol === 'cliente') {
        <!-- datos del técnico -->
        @if (otroUsuario.nombreComercial) {
            <p class="text-gray-700">Nombre comercial: {{ otroUsuario.nombreComercial }}</p>
        }
    }

    }
  </div>

</div>

}
